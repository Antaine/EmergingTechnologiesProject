<!-- Antaine O Congaile - G00347577-->
<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="UTF-8">
    <style>
      body {
        margin: 0px;
        padding: 0px;
        background-color: darkblue;
      }

      canvas {
        background-color: black;
        align-self: center;
      }

      #paint {
      width: 250px;
      height: 200px;
      background-color: black;
  }

      div.btnY{
        position: relative;
      }

      div.btnX{
        width: 40%;
        display: flex;
        justify-content: center; 
      }
       
    </style>
  </head>

  <body data-rsssl=1>
  	<div id="paint">
      <canvas id="myCanvas"></canvas>
    </div>

    <div id="btn" class="btnY">
      <div id="btnX">
        <button onclick="onClear()">Clear</button>
        <button onclick="onSave1()">Calculate</button></div>
        <h2 id="result"></h2>
        
    </div>
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    <script>
      var canvas = document.getElementById('myCanvas');
      const ctx = canvas.getContext('2d');

 
      var painting = document.getElementById('paint');
      var paint_style = getComputedStyle(painting);
      canvas.width = parseInt(paint_style.getPropertyValue('width'));
      canvas.height = parseInt(paint_style.getPropertyValue('height'));

      var mouse = {x: 0, y: 0};
 
      canvas.addEventListener('mousemove', function(e) {
        mouse.x = e.pageX - this.offsetLeft;
        mouse.y = e.pageY - this.offsetTop;
      }, false);

      ctx.lineWidth = 2;
      ctx.lineJoin = 'round';
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#00CC99';
       
      canvas.addEventListener('mousedown', function(e) {
        ctx.beginPath();
        ctx.moveTo(mouse.x, mouse.y);
        canvas.addEventListener('mousemove', onPaint, false);
      }, false);
       
      canvas.addEventListener('mouseup', function() {
          canvas.removeEventListener('mousemove', onPaint, false);
      }, false);
 
      var onPaint = function() {
          ctx.lineTo(mouse.x, mouse.y);
          ctx.stroke();
      };

   /*   var onClear = function() {
         // ctx.Clear();
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          console.log("Test");
      };*/

      function onClear() {
         ctx.clearRect(0, 0, canvas.width, canvas.height);
      };

      var onSave = function() {

        var dataURL = canvas.toDataURL();
        var image = canvas.toDataURL("/image/png").replace("image/png", "image/octet-stream");  // here is the most important part because if you dont replace you will get a DOM 18 exception.
        window.location.href=image; // it will save locally*/
      };

      var image64 = canvas.toDataURL
     // 

      var onSave1 = function()
      {
        var canvas = document.getElementById('myCanvas');
        var dataURL = canvas.toDataURL();
        console.log(canvas.toDataURL());
        result = "Test";
        //Ajax
        $.ajax({
          type: 'POST',
          url:'/image',
          data: {
            imgBase64: dataURL
          }
        }).done(function (data){
          console.log('Posted');
          console.log(data);
          $("#result").empty().append(data);
        });
      }
        
    /*  var dataURL = canvas.toDataURL();
      console.log(dataURL);
      $.POST("/calculate",{"image": dataURL}, function(data){

      })*/
     /* $.ajax({
          type: "POST",
          url: "script.php",
          data: { 
             imgBase64: dataURL
          }
        }).done(function(o) {
          console.log('saved'); 
          // If you want the file to be visible in the browser 
          // - please modify the callback in javascript. All you
          // need is to return the url to the file, you just saved 
          // and than put the image in your browser.
        });*/
      
    </script>
       <!-- Link  to Script

   <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <-->
  </body>
</html>            